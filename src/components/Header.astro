---
import { Image } from "astro:assets";
import myImage from "../assets/MyLogoDabs.png";
import { Menu, X } from "@lucide/astro";
---

<header class="w-full h-auto mb-5">
  <nav class="flex justify-between bg-[#3A3335]">
    <ul class="hidden md:inline">
      <a href="">Home</a>
      <a href="">About</a>
      <a href="">Service</a>
    </ul>
    <div class="flex items-center gap-x-3">
      <Image
        src={myImage}
        alt="Dabs logo"
        layout="constrained"
        class="ml-5"
        width={80}
        height={80}
      />
      <span class="hidden text-2xl font-bold">DABS</span>
      <div class="hidden md:flex md:flex-col">
        <span>Made By</span>
        <span>Daniel Serna</span>
      </div>
    </div>
    <ul class="hidden md:inline">
      <a href="">Resume</a>
      <a href="">Project</a>
      <a href="">Contact</a>
    </ul>
    <button id="menu-btn" class="z-40 mr-4 text-white md:hidden">
      <span id="menu-burguer-span" class="icon-open"
        ><Menu class="w-10 h-10" /></span
      >
    </button>
  </nav>
  <button id="menu-btn-x" class="fixed top-4 right-4 text-white z-40">
    <span id="menu-x-span" class="icon-close hidden"
      ><X class="w-10 h-10" /></span
    >
  </button>
  <div
    id="mobile-menu"
    class="fixed top-0 right-0 w-20 h-20 bg-primary rounded-full menu-closed transform transition-transform duration-500 ease-in-out z-20"
  >
  </div>
  <div
    id="mobile-menu-list"
    class="menu-list-closed relative transition-opacity duration-500 z-30"
  >
    <a
      href="#home"
      class="absolute opacity-0 transition-all duration-400 ease-in-out">HOME</a
    >
    <a
      href="#work-experience"
      class="absolute opacity-0 transition-all duration-400 ease-in-out"
      >WORK EXPERIENCE</a
    >
    <a
      href="#why-hire-me"
      class="absolute opacity-0 transition-all duration-400 ease-in-out"
      >WHY HIRE ME</a
    >
    <a
      href="#projects"
      class="absolute opacity-0 transition-all duration-400 ease-in-out"
      >PROJECTS</a
    >
    <a
      href="#tech-stack"
      class="absolute opacity-0 transition-all duration-400 ease-in-out"
      >TECH STACK</a
    >
  </div>
</header>

<style>
  @reference "../styles/global.css"

  span {
    font-family: "Nunito", sans-serif;
  }

  #mobile-menu-list {
    @apply fixed inset-0 w-full text-white flex flex-col items-center justify-start text-4xl font-bold space-y-10;
  }

  .menu-open {
    transform: translate(0, 100%);
    transform: scale(25);
  }

  .menu-closed {
    transform: translate(100%, 0);
  }

  .menu-list-open {
    @apply opacity-100 h-dvh;
  }

  .menu-list-closed {
    @apply opacity-0 h-0;
  }
</style>

<script>
  const menuBtn = document.getElementById("menu-btn");
  const menuBtnX = document.getElementById("menu-btn-x");
  const menu = document.getElementById("mobile-menu");
  const menuList = document.getElementById("mobile-menu-list");
  const spanBurguerMenu = document.getElementById("menu-burguer-span");
  const spanXMenu = document.getElementById("menu-x-span");
  const linksMobileMenu = menuList?.querySelectorAll("a");

  let isOpen = false;

  const toggleMenu = () => {
    isOpen = !isOpen;
    const translateYStart = 100;
    let translateYQuantity = translateYStart;

    spanBurguerMenu?.classList.toggle("hidden", isOpen);
    spanXMenu?.classList.toggle("hidden", !isOpen);
    menu?.classList.toggle("menu-open", isOpen);
    menu?.classList.toggle("menu-closed", !isOpen);
    menuList?.classList.toggle("menu-list-open", isOpen);
    menuList?.classList.toggle("menu-list-closed", !isOpen);

    if (isOpen) {
      setTimeout(() => {
        linksMobileMenu?.forEach((link) => {
          link.style.transform = `translateY(${translateYQuantity}px)`;
          link.classList.replace("opacity-0", "opacity-100");
          translateYQuantity += 100;
        });
      }, 100);
    } else {
      linksMobileMenu?.forEach((link) => {
        link.style.removeProperty("transform");
        link.classList.replace("opacity-100", "opacity-0");
      });
    }
  };

  menuBtn?.addEventListener("click", toggleMenu);
  menuBtnX?.addEventListener("click", toggleMenu);

  // Opcional: cerrar al hacer clic en un link
  linksMobileMenu?.forEach((link) => {
    link.addEventListener("click", () => {
      if (isOpen) toggleMenu();
    });
  });
</script>
